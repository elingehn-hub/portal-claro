
<!DOCTYPE html>
<html lang='es'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>Resumen Interactivo Completo</title>

<style>
:root{--rojo:#d0021b; --gris1:#111; --gris2:#333; --gris3:#777; --gris4:#eee; --blanco:#fff; --negro:#000;}
body{font-family:Arial, Helvetica, sans-serif; background-color:var(--blanco); color:var(--negro); margin:0;}
header{background:var(--negro); color:var(--blanco); padding:16px 24px; box-shadow:0 2px 6px rgba(0,0,0,0.2);} 
header h1{margin:0; font-size:22px; color:var(--rojo);} 
.container{padding:24px;}
.cards{display:flex; flex-wrap:wrap; gap:16px; margin:16px 0;}
.card{flex:1 1 240px; background:var(--gris2); color:var(--blanco); padding:16px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.15);} 
.card h3{margin:0 0 8px 0; font-weight:600;}
.card .value{font-size:28px; font-weight:700;}
.card.alt{background:var(--rojo);} 
.controls{display:flex; gap:12px; align-items:center; margin:20px 0;}
.select{padding:10px; border:1px solid var(--gris3); border-radius:6px; background:var(--gris4); color:var(--negro);} 
.section-title{margin:24px 0 8px; color:var(--gris1); border-left:6px solid var(--rojo); padding-left:10px;}
.chart{margin:10px 0;}
.table{width:100%; border-collapse:collapse; margin:16px 0;}
.table th, .table td{border:1px solid var(--gris3); padding:8px; text-align:center;}
.table th{background:var(--gris1); color:var(--blanco);} 
.table-striped tr:nth-child(even){background:var(--gris4);} 
footer{background:var(--gris1); color:var(--blanco); padding:16px; text-align:center;}
.small{font-size:12px; color:var(--gris3);} 
</style>

</head>
<body>
<header>
  <h1>Resumen Interactivo de Contratos y Clases de Servicio</h1>
</header>
<div class='container'>
  
<div class='cards'>
  <div class='card alt'>
    <h3>Total Contratos Únicos</h3>
    <div class='value'>802</div>
  </div>
  <div class='card'>
    <h3>Periodos Únicos</h3>
    <div class='value'>13</div>
  </div>
  <div class='card' style='background:#555;'>
    <h3>Clases de Servicio Únicas</h3>
    <div class='value'>16</div>
  </div>
</div>

  <h2 class='section-title'>Filtros</h2>
  
<div class='controls'>
  <label for='periodSel'><strong>Periodo:</strong></label>
  <select id='periodSel' class='select'></select>
  <label for='serviceSel'><strong>Clase de servicio:</strong></label>
  <select id='serviceSel' class='select' style='min-width:280px;'></select>
</div>

  <h2 class='section-title'>Gráfico de Barras</h2>
  <div id='barDiv' class='chart'></div>
  <h2 class='section-title'>Gráfico de Participación</h2>
  <div id='pieDiv' class='chart'></div>
  <h2 class='section-title'>Resumen por IDPERIODO</h2>
  <table border="1" class="dataframe table table-striped">
  <thead>
    <tr style="text-align: right;">
      <th>IDPERIODO</th>
      <th>CONTRATOS</th>
      <th>COMPONENTES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>202410</td>
      <td>89</td>
      <td>107</td>
    </tr>
    <tr>
      <td>202411</td>
      <td>180</td>
      <td>203</td>
    </tr>
    <tr>
      <td>202412</td>
      <td>269</td>
      <td>310</td>
    </tr>
    <tr>
      <td>202501</td>
      <td>373</td>
      <td>436</td>
    </tr>
    <tr>
      <td>202502</td>
      <td>432</td>
      <td>505</td>
    </tr>
    <tr>
      <td>202503</td>
      <td>463</td>
      <td>543</td>
    </tr>
    <tr>
      <td>202504</td>
      <td>32</td>
      <td>38</td>
    </tr>
    <tr>
      <td>202505</td>
      <td>543</td>
      <td>630</td>
    </tr>
    <tr>
      <td>202506</td>
      <td>577</td>
      <td>668</td>
    </tr>
    <tr>
      <td>202507</td>
      <td>603</td>
      <td>698</td>
    </tr>
    <tr>
      <td>202508</td>
      <td>632</td>
      <td>728</td>
    </tr>
    <tr>
      <td>202509</td>
      <td>653</td>
      <td>750</td>
    </tr>
    <tr>
      <td>202510</td>
      <td>680</td>
      <td>777</td>
    </tr>
  </tbody>
</table>
  <h2 class='section-title'>Resumen por CLASE_SERVICIO (Contratos únicos por periodo)</h2>
  <table border="1" class="dataframe table table-striped">
  <thead>
    <tr style="text-align: right;">
      <th>IDPERIODO</th>
      <th>CLASE_SERVICIO</th>
      <th>202410</th>
      <th>202411</th>
      <th>202412</th>
      <th>202501</th>
      <th>202502</th>
      <th>202503</th>
      <th>202504</th>
      <th>202505</th>
      <th>202506</th>
      <th>202507</th>
      <th>202508</th>
      <th>202509</th>
      <th>202510</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>* PAQUETE HBO</td>
      <td>9</td>
      <td>24</td>
      <td>34</td>
      <td>44</td>
      <td>48</td>
      <td>50</td>
      <td>3</td>
      <td>58</td>
      <td>59</td>
      <td>61</td>
      <td>65</td>
      <td>69</td>
      <td>76</td>
    </tr>
    <tr>
      <th></th>
      <td>* PAQUETE HBO + HBO HD</td>
      <td>40</td>
      <td>65</td>
      <td>101</td>
      <td>138</td>
      <td>151</td>
      <td>169</td>
      <td>15</td>
      <td>197</td>
      <td>209</td>
      <td>226</td>
      <td>232</td>
      <td>236</td>
      <td>243</td>
    </tr>
    <tr>
      <th></th>
      <td>* PAQUETE UNIVERSAL PLUS</td>
      <td>15</td>
      <td>31</td>
      <td>46</td>
      <td>62</td>
      <td>77</td>
      <td>83</td>
      <td>8</td>
      <td>97</td>
      <td>102</td>
      <td>107</td>
      <td>115</td>
      <td>118</td>
      <td>113</td>
    </tr>
    <tr>
      <th></th>
      <td>* PAQUETE UNIVERSAL PLUS + HD</td>
      <td>11</td>
      <td>23</td>
      <td>46</td>
      <td>74</td>
      <td>88</td>
      <td>95</td>
      <td>7</td>
      <td>107</td>
      <td>113</td>
      <td>114</td>
      <td>117</td>
      <td>120</td>
      <td>121</td>
    </tr>
    <tr>
      <th></th>
      <td>DTH - PAQUETE MINI HBO</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>12</td>
      <td>13</td>
      <td>13</td>
      <td>0</td>
      <td>14</td>
      <td>14</td>
      <td>16</td>
      <td>16</td>
      <td>16</td>
      <td>15</td>
    </tr>
    <tr>
      <th></th>
      <td>DTH - PAQUETE MINI Universal+</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <th></th>
      <td>DTH - Paquete HBO</td>
      <td>15</td>
      <td>27</td>
      <td>37</td>
      <td>39</td>
      <td>43</td>
      <td>41</td>
      <td>3</td>
      <td>48</td>
      <td>52</td>
      <td>48</td>
      <td>51</td>
      <td>55</td>
      <td>55</td>
    </tr>
    <tr>
      <th></th>
      <td>DTH - Paquete Universal+</td>
      <td>4</td>
      <td>5</td>
      <td>10</td>
      <td>14</td>
      <td>21</td>
      <td>22</td>
      <td>0</td>
      <td>24</td>
      <td>24</td>
      <td>22</td>
      <td>21</td>
      <td>21</td>
      <td>23</td>
    </tr>
    <tr>
      <th></th>
      <td>DTH Paquete CLARO MAX</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th></th>
      <td>GPON Paquete CLARO MAX</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>8</td>
      <td>8</td>
      <td>11</td>
      <td>13</td>
      <td>17</td>
    </tr>
    <tr>
      <th></th>
      <td>GPON Paquete UNIVERSAL 2025</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th></th>
      <td>GPON Paquete Universal PREMIUM</td>
      <td>7</td>
      <td>15</td>
      <td>21</td>
      <td>37</td>
      <td>43</td>
      <td>47</td>
      <td>2</td>
      <td>53</td>
      <td>58</td>
      <td>65</td>
      <td>69</td>
      <td>73</td>
      <td>82</td>
    </tr>
    <tr>
      <th></th>
      <td>HFC Paquete CLARO MAX</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th></th>
      <td>HFC Paquete UNIVERSAL 2025</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th></th>
      <td>Paquete Mini HBO HD</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th></th>
      <td>Paquete Mini Universal Plus HD</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<footer>
  Generado automáticamente — Paleta: rojo, grises, blanco y negro.
</footer>

<script src='https://cdn.plot.ly/plotly-2.24.1.min.js'></script>
<script>
const rawData = [{"IDPERIODO": 202410, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 9}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 40}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 15}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 11}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 2}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 2}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 15}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 4}, {"IDPERIODO": 202410, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 7}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 24}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 65}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 31}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 23}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 5}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 3}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 27}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 5}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 15}, {"IDPERIODO": 202411, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 1}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 34}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 101}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 46}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 46}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 5}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 2}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 37}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 10}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 21}, {"IDPERIODO": 202412, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 2}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 44}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 138}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 62}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 74}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 12}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 39}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 14}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 37}, {"IDPERIODO": 202501, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 3}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 48}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 151}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 77}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 88}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 13}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 43}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 21}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 43}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 1}, {"IDPERIODO": 202502, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 4}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 50}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 169}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 83}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 95}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 13}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 41}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 22}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 47}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 1}, {"IDPERIODO": 202503, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 4}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 3}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 15}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 8}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 7}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 3}, {"IDPERIODO": 202504, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 2}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 58}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 197}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 97}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 107}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 14}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 48}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 24}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 3}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 53}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 4}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 2}, {"IDPERIODO": 202505, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 6}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 59}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 209}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 102}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 113}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 14}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 52}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 24}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 8}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 58}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 4}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 2}, {"IDPERIODO": 202506, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 6}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 61}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 226}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 107}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 114}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 16}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 48}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 22}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 8}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 65}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 5}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 4}, {"IDPERIODO": 202507, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 7}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 65}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 232}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 115}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 117}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 16}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 51}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 21}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 11}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 69}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 6}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 4}, {"IDPERIODO": 202508, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 6}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 69}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 236}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 118}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 120}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 16}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 55}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 21}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 13}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 73}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 5}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "HFC Paquete UNIVERSAL 2025", "Cantidad": 1}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 3}, {"IDPERIODO": 202509, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 6}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "* PAQUETE HBO", "Cantidad": 76}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "* PAQUETE HBO + HBO HD", "Cantidad": 243}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS", "Cantidad": 113}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "* PAQUETE UNIVERSAL PLUS + HD", "Cantidad": 121}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "DTH - PAQUETE MINI HBO", "Cantidad": 15}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "DTH - PAQUETE MINI Universal+", "Cantidad": 7}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "DTH - Paquete HBO", "Cantidad": 55}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "DTH - Paquete Universal+", "Cantidad": 23}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "DTH Paquete CLARO MAX", "Cantidad": 2}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "GPON Paquete CLARO MAX", "Cantidad": 17}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "GPON Paquete UNIVERSAL 2025", "Cantidad": 3}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "GPON Paquete Universal PREMIUM", "Cantidad": 82}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "HFC Paquete CLARO MAX", "Cantidad": 5}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "HFC Paquete UNIVERSAL 2025", "Cantidad": 1}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "Paquete Mini HBO HD", "Cantidad": 3}, {"IDPERIODO": 202510, "CLASE_SERVICIO": "Paquete Mini Universal Plus HD", "Cantidad": 6}];
const allPeriods = [202410, 202411, 202412, 202501, 202502, 202503, 202504, 202505, 202506, 202507, 202508, 202509, 202510];
const allServices = ["* PAQUETE HBO", "* PAQUETE HBO + HBO HD", "* PAQUETE UNIVERSAL PLUS", "* PAQUETE UNIVERSAL PLUS + HD", "DTH - PAQUETE MINI HBO", "DTH - PAQUETE MINI Universal+", "DTH - Paquete HBO", "DTH - Paquete Universal+", "DTH Paquete CLARO MAX", "GPON Paquete CLARO MAX", "GPON Paquete UNIVERSAL 2025", "GPON Paquete Universal PREMIUM", "HFC Paquete CLARO MAX", "HFC Paquete UNIVERSAL 2025", "Paquete Mini HBO HD", "Paquete Mini Universal Plus HD"];

function filterData(period, service){
  return rawData.filter(d => (period==='Todos' || d.IDPERIODO==period) && (service==='Todos' || d.CLASE_SERVICIO===service));
}

function groupByService(data){
  const agg={};
  data.forEach(d=>{
    agg[d.CLASE_SERVICIO] = (agg[d.CLASE_SERVICIO]||0) + d.Cantidad;
  });
  const labels = Object.keys(agg);
  const values = labels.map(k=>agg[k]);
  return {labels, values};
}

function render(period='Todos', service='Todos'){
  const data = filterData(period, service);
  const x = data.map(d=>d.IDPERIODO);
  const y = data.map(d=>d.Cantidad);
  const c = data.map(d=>d.CLASE_SERVICIO);
  const barTrace = {
    type:'bar', x:x, y:y, text:c, marker:{color:'#d0021b'},
    hovertemplate:'Periodo %{x}<br>Clase %{text}<br>Cantidad %{y}<extra></extra>'
  };
  Plotly.newPlot('barDiv', [barTrace], {
    title:'Contratos únicos por CLASE_SERVICIO y IDPERIODO',
    plot_bgcolor:'#fff', paper_bgcolor:'#fff', font:{color:'#000'},
    xaxis:{type:'category', title:'IDPERIODO'}, yaxis:{title:'Cantidad'}
  });

  const gp = groupByService(filterData('Todos', service));
  const pieTrace = {type:'pie', labels:gp.labels, values:gp.values, textinfo:'percent+label', marker:{line:{color:'#fff', width:2}}};
  Plotly.newPlot('pieDiv', [pieTrace], {title:'Participación total por CLASE_SERVICIO', font:{color:'#000'}, paper_bgcolor:'#fff'});
}

function populateSelectors(){
  const pSel = document.getElementById('periodSel');
  const sSel = document.getElementById('serviceSel');
  const pOpt = new Option('Todos','Todos'); pSel.add(pOpt);
  allPeriods.forEach(p=>pSel.add(new Option(p,p)));
  const sOpt = new Option('Todos','Todos'); sSel.add(sOpt);
  allServices.forEach(s=>sSel.add(new Option(s,s)));
  pSel.addEventListener('change', ()=>render(pSel.value, sSel.value));
  sSel.addEventListener('change', ()=>render(pSel.value, sSel.value));
}

window.addEventListener('DOMContentLoaded', ()=>{populateSelectors(); render();});
</script>

</body>
</html>
